{% from "nav.html" import links %}

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>QuizzyLead Test Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename = 'style.css') }}"
  </head>
  <body>
        <div class="header mb-2">
            {{ links(user) }}
        </div>

        <div class="question container border text-light p-3">
          <h3 style="color: yellow;">{{ tests }}</h3>
          <br>
          
          <form action="/submit_test/{{ test_id }}/" method="POST">
            
            {% for question in quiz_questions %}            
              {% set number = question[0] | string %}
              
                <div class="card">
                    <div class="card-header text-dark">
                        <h4>Q{{ question[3] }}: {{ question[4] }}</h4> 
                    </div>

                    <div class="card-body text-dark">
                      <label class="radio-label {% if user_selections[number] == 'A' and user_selections[number] == question[9] %}correct{% elif user_selections[number] == 'A' and user_selections[number] != question[9] %}wrong{% endif %}">
                        <input type="radio" name="q{{ question[0] }}" value="A" {% if user_selections[number] == 'A' %}checked{% endif %}>
                          A) {{ question[5] }}
                      </label>
                  
                      <label class="radio-label {% if user_selections[number] == 'B' and user_selections[number] == question[9] %}correct{% elif user_selections[number] == 'B' and user_selections[number] != question[9] %}wrong{% endif %}">
                          <input type="radio" name="q{{ question[0] }}" value="B" {% if user_selections[number] == 'B' %}checked{% endif %}>
                          B) {{ question[6] }}
                      </label>
                  
                      <label class="radio-label {% if user_selections[number] == 'C' and user_selections[number] == question[9] %}correct{% elif user_selections[number] == 'C' and user_selections[number] != question[9] %}wrong{% endif %}">
                          <input type="radio" name="q{{ question[0] }}" value="C" {% if user_selections[number] == 'C' %}checked{% endif %}>
                          C) {{ question[7] }}
                      </label>
                  
                      <label class="radio-label {% if user_selections[number] == 'D' and user_selections[number] == question[9] %}correct{% elif user_selections[number] == 'D' and user_selections[number] != question[9] %}wrong{% endif %}">
                          <input type="radio" name="q{{ question[0] }}" value="D" {% if user_selections[number] == 'D' %}checked{% endif %}>
                          D) {{ question[8] }}
                      </label>
                  </div>

                    <div class="card-body">
                        {% if test_taken or teacher %}
                            <p class="text-danger">                   
                                Correct Answer: {{ question[9] }} <br>
                                Explanation: {{ question[10] }}
                            </p>
                        {% endif %}
                    </div>
                </div>
                <br>
          {% endfor %}



            {% if test_taken %}
            <div class="d-grid gap-2">
                <button type="button" class="btn btn-warning" disabled>Test Already Taken</button>
                <p style="text-align: center;">
                  Score: {{ score }} <br>
                  Total: {{ total }} <br>
                  Percent: {{ (score/total)*100 }}
                </p>
              </div>

            {% elif teacher %}
            <div class="d-grid gap-2">
              <button type="button" class="btn btn-warning" onclick="goBack()">Go Back</button>
            </div>
            {% else %}
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary col-md-3">Submit</button>
            </div>
            {% endif %}
        </form>
        
  </div>
    
    
    
    <script>
      function goBack() {
        history.back();
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
  </body>
</html>